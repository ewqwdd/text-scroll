<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Agdasima:wght@400;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <section id="first"></section>
    <section id="moving">
      <div id="sticky">
        <div id="scroll-area">
          <div id="moving-content-wrp">
            <h3>CASUAL GAME DEVELOPMENT</h3>
            <h3>AAA GAME DEVELOPMENT</h3>
            <h3>MOBILE DEVELOPMENT</h3>
            <h3>ANIMATION</h3>
            <h3>REALISTIC MODELING</h3>
            <h3>CASUAL GAME DEVELOPMENT</h3>
            <h3>AAA GAME DEVELOPMENT</h3>
            <h3>MOBILE DEVELOPMENT</h3>
            <h3>ANIMATION</h3>
            <h3>REALISTIC MODELING</h3>
          </div>
        </div>
        <span id="moving-description"> </span>
      </div>
    </section>
    <section id="third"></section>
    <script>
      const descriptions = [
        "Creating high-quality, immersive games with cutting-edge graphics and complex gameplay, designed for the most demanding players.",
        "Creating high-quality, imeplay, designed for the most demanding players.",
        "Creating high-quality, immersive games with cutting-edge graphics and complex gameplay, designed for the most demanding players.",
        "Creating high-quality, immersive games with cutting-edge graphics and complex gameplay, designed for the most demanding players.",
        "Creating high-quality, immersivith cutting-edge graphics and complex gameplay, designed for the most demanding players.",
        "Creating high-quality, immersive games with cutting-edge graphics and compeplay, designed for the most demanding players.",
        "Creating high-quality, immersive games with cutting-edge graphics and complex gameplay, designed for the most demanding players.",
        "Creating high-quality, immersive games with cutting-edge graphics and complex gameplay, designed for the most demanding players.",
        "Creating high-quality, immersive games with cutting-edge graphics and complex gameplay, designed for the most demanding players.",
        "Creating high-quality, immersive games with cutting-edge graphics and complex gameplay, designed for the most demanding players.",
      ];
      const sticky = document.getElementById("sticky");
      const scrollArea = document.getElementById("scroll-area");
      const moving = document.getElementById("moving");
      const description = document.getElementById("moving-description");
      const movingContent = document.getElementById("moving-content-wrp");
      const timer = {};
      let current = 0;
      scrollArea.style.height = scrollArea.querySelector("h3").offsetHeight + "px";

      const changeDescription = (index) => {
        if (index === current) return;
        description.style.opacity = 0;
        current = index;
        setTimeout(() => {
          description.innerHTML = descriptions[index];
          description.style.opacity = 1;
        }, 300);
      };

      const onScroll = () => {
        const diff = sticky.offsetTop - moving.offsetTop;
        const middle = scrollArea.offsetTop + scrollArea.offsetHeight / 2;
        const percentage = diff / (-moving.offsetHeight + sticky.offsetHeight);
        const sliderElements = scrollArea.querySelectorAll("h3");
        const value =
          (movingContent.offsetHeight * percentage * (sliderElements.length - 1)) / sliderElements.length;
        let Z;

        sliderElements.forEach((elem, index) => {
          const half = scrollArea.offsetHeight / 2;
          const middle = scrollArea.offsetTop + half;
          let diff = elem.offsetTop + value;
          if (Math.abs(diff) < scrollArea.offsetHeight / 2.4) {
            diff = diff / 2;
            elem.style.opacity = 1;
            changeDescription(index);
            if (timer[index]) clearTimeout(timer);
          } else {
            elem.style.opacity = 1 - Math.abs(diff) / middle - 0.3;
          }
          Z = (Math.abs(diff) / middle) * 50;

          elem.style.transform = `translateZ(-${Z}px)`;
          elem.style.rotate = `x ${-diff / 15}deg`;
          movingContent.style.translate = `0 ${Math.round(value)}px`;
        });
      };

      window.addEventListener("scroll", onScroll);
      window.addEventListener("load", onScroll);
      window.addEventListener("resize", () => {
        scrollArea.style.height = scrollArea.querySelector("h3").offsetHeight + "px";
      });
    </script>
  </body>
</html>
